{
  "name": "DHO - turnover",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.prompt }}",
        "options": {
          "systemMessage": "=Voc√™ √© um analista de RH com experi√™ncia em prever desligamentos volunt√°rios.\n\nCom base nos dados fornecidos, analise o risco de **turnover volunt√°rio** do colaborador e classifique como: **baixo**, **m√©dio** ou **alto**.\n\nA resposta deve estar **formatada com clareza**, seguindo este modelo:\n\n---\n\n### üîç An√°lise de Risco de Turnover Volunt√°rio ‚Äì {{nome}}\n\n**üü¢ Risco estimado: _[baixo | m√©dio | alto]_**\n\n---\n\n### üßæ Justificativa detalhada\n\n1. **Tempo de empresa e tempo no cargo**  \nExplique a rela√ß√£o entre tempo na empresa e no cargo atual com o risco de sa√≠da.\n\n2. **Sal√°rio**  \nComente se o sal√°rio est√° adequado ou pode estar gerando insatisfa√ß√£o.\n\n3. **Avalia√ß√£o de desempenho e feedbacks**  \nInclua os resultados das avalia√ß√µes e o tipo de feedbacks recebidos.\n\n4. **Clima organizacional**  \nInclua a nota de clima e se o colaborador participou da pesquisa. Analise impacto disso.\n\n5. **Participa√ß√£o em a√ß√µes da empresa**  \nComente se o n√≠vel de participa√ß√£o indica engajamento ou distanciamento.\n\n6. **Absente√≠smo**  \nExplique se o n√∫mero de faltas e atrasos √© preocupante.\n\n7. **Horas extras e banco de horas**  \nIndique se h√° sobrecarga ou comprometimento.\n\n8. **Participa√ß√£o em reuni√µes/eventos**  \nAnalise o n√≠vel de envolvimento com a equipe e a empresa.\n\n9. **Participa√ß√£o em b√¥nus/PLR**  \nComente se isso pode ser um fator de reten√ß√£o.\n\n10. **Hist√≥rico de desligamento da empresa**  \nRelacione o ambiente da empresa com a chance de desligamento desse colaborador.\n\n---\n\n### ‚úÖ Conclus√£o\n\nFinalize com um **resumo claro**, refor√ßando o risco identificado e dando **uma sugest√£o de a√ß√£o** (ex: acompanhar mais de perto, incluir em plano de desenvolvimento, etc.).\n\nA resposta deve estar estruturada e f√°cil de ler. Use **negrito**, **t√≠tulos**, e **par√°grafos curtos**.  \nSempre entregue a sa√≠da no mesmo padr√£o para facilitar a leitura e uso em relat√≥rios.\n\n---\n\nQuer que eu gere esse prompt j√° dentro de um `.json` pronto para importar no seu `AI Agent` no n8n?\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        -60,
        -540
      ],
      "id": "b9055321-363f-48c8-bafe-e16ee79f07a9",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Aggregate1').item.json.data }}",
        "contextWindowLength": 1
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        40,
        -300
      ],
      "id": "b6468f1b-68f2-4f58-9cdc-ce28f6b028a1",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "fromEmail": "evilasio.f.filho@gmail.com",
        "toEmail": "evilasio.dev@gmail.com",
        "subject": "[DHO] Turnover - Teste",
        "emailFormat": "text",
        "text": "={{ $json.output }}",
        "options": {
          "appendAttribution": false,
          "ccEmail": "felipe.gomes@smartspace.us,marcio.greike@digivox.com.br,jefferson.silva@smartspace.us,naydlene.brito@smartspace.us"
        }
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        280,
        -540
      ],
      "id": "98e78e27-eab6-4eab-b001-c44eb96f571f",
      "name": "Send Email",
      "webhookId": "3f428744-9817-44a7-937d-47d257680e27",
      "credentials": {
        "smtp": {
          "id": "5uUfkLXA1kYxWVhe",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -1080,
        -540
      ],
      "id": "ce55bfbe-bf6c-41a2-8f52-2a7965f4b6bc",
      "name": "When clicking ‚ÄòTest workflow‚Äô"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1ZzESLnY5t910JwH4VRF_38N00t4_wdB0-EPotHW3UZU/edit?gid=1581666405#gid=1581666405",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1581666405,
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ZzESLnY5t910JwH4VRF_38N00t4_wdB0-EPotHW3UZU/edit#gid=1581666405"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -880,
        -540
      ],
      "id": "52b2d4d6-546a-4646-b30a-9706bae1090f",
      "name": "Google Sheets",
      "credentials": {
        "googleApi": {
          "id": "PAqomY7ezS7eW0KK",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -680,
        -540
      ],
      "id": "d697b7f7-fa16-40cf-b8ab-04ba09938f74",
      "name": "Aggregate1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -100,
        -300
      ],
      "id": "00443ce3-8831-4710-b58a-2425712c4419",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "3t9EzbemEgbTM58R",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const colaboradores = $json.data;\n\nconst resultados = colaboradores.map(colaborador => {\n  const prompt = `\nVoc√™ √© um analista de RH com experi√™ncia em prever desligamentos volunt√°rios.\n\nCom base nas informa√ß√µes fornecidas de um colaborador, diga se ele tem **alto**, **m√©dio** ou **baixo risco de turnover volunt√°rio**.\n\nConsidere fatores como tempo de empresa, sal√°rio, feedbacks, clima organizacional e hist√≥rico de avalia√ß√£o de desempenho. Justifique brevemente sua resposta.\n\n### Dados do colaborador:\n- ID: ${colaborador[\"ID Colaborador\"]}\n- Idade: ${colaborador[\"Idade\"]}\n- Cargo: ${colaborador[\"Cargo\"]}\n- Departamento: ${colaborador[\"√Årea/Departamento\"]}\n- Tempo de empresa: ${colaborador[\"Tempo de Empresa (anos)\"]} anos\n- Tempo no cargo atual: ${colaborador[\"Tempo no Cargo Atual (anos)\"]} anos\n- Sal√°rio atual: R$ ${colaborador[\"Sal√°rio Atual\"]}\n- Avalia√ß√£o de desempenho: ${colaborador[\"Avalia√ß√µes de Desempenho\"]}\n- Feedbacks: ${colaborador[\"Feedbacks Quali/Quanti\"]}\n- Clima organizacional: ${colaborador[\"Resultado Pesquisa Interna\"]} (participou da pesquisa? ${colaborador[\"Participa√ß√£o em Pesquisas de Clima\"]})\n- Participa√ß√£o em a√ß√µes da empresa: ${colaborador[\"Participa√ß√£o em A√ß√µes da Empresa\"]}\n- Absente√≠smo: ${colaborador[\"Absente√≠smo (dias/ano)\"]} dias/ano\n- Horas extras por m√™s: ${colaborador[\"Horas Extras (m√™s)\"]}\n- Banco de horas: ${colaborador[\"Banco de Horas\"]}\n- Participa√ß√£o em reuni√µes/eventos: ${colaborador[\"Participa√ß√£o em Reuni√µes/Eventos\"]}\n- Participa√ß√£o em b√¥nus/PLR: ${colaborador[\"Participa√ß√£o em B√¥nus/PLR\"]}\n- Hist√≥rico de aumentos: ${colaborador[\"Hist√≥rico de Aumentos\"]}\n- Benef√≠cios recebidos: ${colaborador[\"Benef√≠cios Recebidos\"]}\n\n### Turnover hist√≥rico da empresa:\n- Motivo de desligamento (se houver): ${colaborador[\"Motivo Desligamento (se houver)\"]}\n- Tempo at√© pedido de demiss√£o: ${colaborador[\"Tempo at√© Pedido de Demiss√£o (anos)\"]} anos\n- Perfil de colaboradores que sa√≠ram: ${colaborador[\"Perfil de Colaboradores que Sa√≠ram\"]}\n- Frequ√™ncia de desligamentos: ${colaborador[\"Frequ√™ncia de Desligamentos\"]}\n\n### Sua resposta:\n`;\n\n  return {\n    json: {\n      prompt,\n      colaboradorId: colaborador[\"ID Colaborador\"]\n    }\n  };\n});\n\nreturn resultados;\n\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -460,
        -540
      ],
      "id": "6dc3847e-8421-4e90-8262-a591b15bfba7",
      "name": "prompt"
    },
    {
      "parameters": {
        "maxItems": 3
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        -240,
        -540
      ],
      "id": "112a1ba1-6f95-4ba1-9807-51e2fe1ba0df",
      "name": "Limit"
    }
  ],
  "pinData": {},
  "connections": {
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Send Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‚ÄòTest workflow‚Äô": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate1": {
      "main": [
        [
          {
            "node": "prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "Aggregate1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "prompt": {
      "main": [
        [
          {
            "node": "Limit",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "94645df9-2629-4d4c-9a00-6bd033ba66a3",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "c3e32651c53c4f90284fa8f787a8ae933348647f3f850e837bd6e72e5fb04f70"
  },
  "id": "2ZeWQhSOTYsBkxUL",
  "tags": [
    {
      "createdAt": "2025-02-20T11:38:11.306Z",
      "updatedAt": "2025-02-20T11:38:11.306Z",
      "id": "Xj53IfBSxC6HcCPe",
      "name": "Desenvolvimento"
    }
  ]
}